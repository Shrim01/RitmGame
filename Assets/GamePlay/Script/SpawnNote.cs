using UnityEngine;

namespace GamePlay.Script
{
    public class SpawnNote : MonoBehaviour
    {
        public new AudioSource audio;
        public LogicScript logic;
        public GameObject note;
        public GameObject longNote;
        public GameObject spinner;
        private float timeSpawn = 5f;
        private float time;
        private float timeStart;

        public double[] timingList;
        private float dspSongTime;
        private float songPosition;
        private float songLength;
        private string listJson;
        private int index;

        private void Start()
        {
            if (Date.Difficult == 0)
                timingList = TimingArrayEasy();
            else if (Date.Difficult == 1)
                timingList = TimingArrayNormal();
            else
                timingList = TimingArrayPy();
            timeStart = 0;
            logic = GameObject.FindGameObjectWithTag("Logic").GetComponent<LogicScript>();
            audio.volume = Date.VolumeSong;
            audio.clip = Resources.Load<AudioClip>("sunset_butttttttt");
            dspSongTime = (float)AudioSettings.dspTime;
            songLength = audio.clip.length;
            audio.Play();
            audio.time = timeStart;
            Date.MaxScore = timingList.Length * 200 + timingList.Length / 2 * timingList.Length;
        }

        void Update()
        {
            logic.UpdateProgressBar((audio.time - timeStart) / (audio.clip.length - timeStart));
            // songPosition = (float)(AudioSettings.dspTime - dspSongTime);
            // if (index < timingList.Length && songPosition > timingList[index] - 10.0f / 6.0f)
            // {
                // Instantiate(note);
                // index++;
            // }

            // if (songPosition > songLength)
                // logic.EndSong();

            time += Time.deltaTime;
            if (time > timeSpawn)
            {
                time = 0;
                Instantiate(note);
            }
        }

        private double[] TimingArrayNormal()
        {
            return new[]
            {
                16.981338500976564,
                18.901338577270509,
                20.84267234802246,
                22.656005859375,
                24.490671157836915,
                26.368005752563478,
                28.288005828857423,
                30.122671127319337,
                31.104005813598634,
                31.552005767822267,
                32.98133850097656,
                33.42933654785156,
                34.858673095703128,
                35.306671142578128,
                36.73600387573242,
                37.16267013549805,
                39.50933837890625,
                41.38667297363281,
                43.242671966552737,
                45.16267013549805,
                46.08000564575195,
                46.97600555419922,
                47.9146728515625,
                48.874671936035159,
                49.83467102050781,
                50.79467010498047,
                51.690670013427737,
                52.629337310791019,
                53.5680046081543,
                54.50667190551758,
                55.466670989990237,
                56.42667007446289,
                57.3440055847168,
                58.26133728027344,
                59.178672790527347,
                60.160003662109378,
                61.1200065612793,
                62.03733825683594,
                62.95466995239258,
                63.89333724975586,
                64.8320083618164,
                65.81333923339844,
                66.73067474365235,
                67.66934204101563,
                68.60800170898438,
                69.54666900634766,
                70.52800750732422,
                71.4453353881836,
                72.3626708984375,
                73.30133819580078,
                74.19734191894531,
                75.13600158691406,
                77.0560073852539,
                78.89067077636719,
                80.78933715820313,
                82.66667175292969,
                84.56533813476563,
                86.4000015258789,
                88.29866790771485,
                90.15467071533203,
                91.60533905029297,
                93.41867065429688,
                95.3600082397461,
                97.15200805664063,
                98.9866714477539,
                100.9493408203125,
                105.08800506591797,
                106.96533966064453,
                108.90666961669922,
                110.74134063720703,
                112.66133880615235,
                114.56000518798828,
                116.43733978271485,
                118.35733795166016,
                121.9840087890625,
                123.90400695800781,
                126.25067138671875,
                128.1493377685547,
                128.5760040283203,
                129.0240020751953,
                129.51467895507813,
                129.96267700195313,
                130.4320068359375,
                130.92266845703126,
                131.41334533691407,
                131.86134338378907,
                132.33067321777345,
                132.8213348388672,
                133.29066467285157,
                135.12533569335938,
                136.0426788330078,
                137.0453338623047,
                137.9840087890625,
                138.92266845703126,
                139.8400115966797,
                140.77867126464845,
                141.67466735839845,
                142.656005859375,
                143.57333374023438,
                144.4906768798828,
                145.42933654785157,
                146.38934326171876,
                147.3280029296875,
                148.24533081054688,
                149.1626739501953,
                150.12266540527345,
                151.04000854492188,
                151.552001953125,
                152.0426788330078,
                152.4906768798828,
                152.9386749267578,
                153.4080047607422,
                153.8560028076172,
                154.38934326171876,
                154.83734130859376,
                155.30667114257813,
                155.79733276367188,
                156.2666778564453,
                156.67201232910157,
                157.1626739501953,
                157.6320037841797,
                158.12266540527345,
                158.59201049804688,
                159.10400390625,
                159.552001953125,
                160.0426788330078,
                160.4906768798828,
                160.9386749267578,
                161.3866729736328,
                161.8560028076172,
                162.32533264160157,
                162.794677734375,
                163.28533935546876,
                163.7760009765625,
                164.24533081054688,
                164.7146759033203,
                165.1840057373047,
                166.0586700439453,
                167.0186767578125,
                168.0,
                168.9386749267578,
                169.8560028076172,
                170.794677734375,
                171.7760009765625,
                172.62933349609376,
                173.6320037841797,
                174.54933166503907,
                175.53067016601563,
                176.42666625976563,
                177.3866729736328,
                178.3040008544922,
                179.20001220703126,
                180.16000366210938,
                182.01600646972657,
                183.97866821289063,
                187.62667846679688,
                189.50399780273438,
                191.44534301757813,
                195.0933380126953
            };
        }

        private double[] TimingArrayEasy()
        {
            return new[]
            {
                17.02394676208496,
                18.943946838378908,
                20.77861213684082,
                22.613279342651368,
                24.469280242919923,
                26.410612106323243,
                30.229280471801759,
                31.99994659423828,
                33.919944763183597,
                35.77594757080078,
                37.6319465637207,
                39.509281158447269,
                41.38661193847656,
                46.101280212402347,
                47.957279205322269,
                49.77061462402344,
                51.669281005859378,
                53.56794738769531,
                55.44527816772461,
                57.3012809753418,
                59.15727996826172,
                60.62928009033203,
                61.5252799987793,
                62.44261169433594,
                63.359947204589847,
                64.29861450195313,
                65.2372817993164,
                66.17594909667969,
                67.11461639404297,
                68.05327606201172,
                69.0132827758789,
                69.95195007324219,
                70.89060974121094,
                71.85061645507813,
                72.7679443359375,
                73.70661163330078,
                74.64527893066406,
                76.47994995117188,
                82.62394714355469,
                84.47994995117188,
                90.06928253173828,
                91.51994323730469,
                92.97061157226563,
                95.25328063964844,
                97.15194702148438,
                99.00794982910156,
                100.8852767944336,
                121.98394775390625,
                123.86128234863281,
                125.75994873046875,
                127.67994689941406,
                129.51461791992188,
                131.4132843017578,
                135.12527465820313,
                136.04261779785157,
                136.95994567871095,
                137.8986053466797,
                138.8372802734375,
                139.7972869873047,
                140.73594665527345,
                141.73861694335938,
                142.59194946289063,
                143.53060913085938,
                144.4692840576172,
                145.4292755126953,
                146.34661865234376,
                147.32794189453126,
                148.2452850341797,
                149.18394470214845,
                150.61328125,
                151.53060913085938,
                152.4479522705078,
                153.38661193847657,
                154.34661865234376,
                155.2852783203125,
                156.1812744140625,
                157.16261291503907,
                158.07994079589845,
                159.03994750976563,
                159.97860717773438,
                160.87461853027345,
                161.8132781982422,
                162.79461669921876,
                163.7332763671875,
                164.65061950683595,
                166.54928588867188,
                168.38394165039063,
                174.05860900878907,
                175.8719482421875,
                187.62661743164063
            };
        }

        private double[] TimingArrayPy()
        {
            return
                new[]
                {
                    12.26013605442177, 12.72453514739229, 13.188934240362812, 13.653333333333334, 14.140952380952381,
                    14.605351473922903, 15.069750566893424, 15.534149659863946, 15.998548752834466, 16.46294784580499,
                    16.950566893424035, 17.41496598639456, 17.87936507936508, 18.3437641723356, 18.83138321995465,
                    19.29578231292517, 19.760181405895693, 20.224580498866214, 20.688979591836734, 21.176598639455783,
                    21.640997732426303, 22.105396825396827, 22.569795918367348, 23.034195011337868, 23.49859410430839,
                    23.962993197278912, 24.450612244897957, 24.91501133786848, 25.379410430839002, 25.843809523809522,
                    26.33142857142857, 26.79582766439909, 27.260226757369615, 27.724625850340136, 28.189024943310656,
                    28.63020408163265, 29.048163265306123, 29.466122448979593, 29.88408163265306, 30.30204081632653,
                    30.766439909297052, 31.230839002267572, 31.71845804988662, 32.182857142857145, 32.64725623582766,
                    33.111655328798186, 33.57605442176871, 34.06367346938776, 34.528072562358275, 34.9924716553288,
                    35.456870748299316, 35.92126984126984, 36.385668934240364, 36.87328798185941, 37.33768707482993,
                    37.802086167800454, 38.26648526077098, 38.75410430839002, 39.21850340136054, 39.68290249433107,
                    40.147301587301584, 40.61170068027211, 41.07609977324263, 41.56371882086168, 42.0281179138322,
                    42.49251700680272, 42.956916099773245, 43.44453514739229, 44.00181405895692, 44.55909297052154,
                    45.069931972789114, 45.53433106575964, 45.99873015873016, 46.46312925170068, 46.9275283446712,
                    47.41514739229025, 47.87954648526077, 48.34394557823129, 48.808344671201816, 49.295963718820865,
                    49.76036281179138, 50.224761904761905, 50.68916099773243, 51.153560090702946, 51.61795918367347,
                    52.10557823129252, 52.569977324263036, 53.03437641723356, 53.498775510204084, 53.9631746031746,
                    54.45079365079365, 54.91519274376417, 55.3795918367347, 55.843990929705214, 56.30839002267574,
                    56.79600907029479, 57.2604081632653, 57.72480725623583, 58.18920634920635, 58.65360544217687,
                    59.14122448979592, 59.60562358276644, 60.070022675736965, 60.53442176870748, 60.998820861678006,
                    61.46321995464853, 61.95083900226757, 62.415238095238095, 62.87963718820862, 63.344036281179136,
                    63.80843537414966, 64.2960544217687, 64.76045351473923, 65.22485260770975, 65.68925170068027,
                    66.1536507936508, 66.61804988662132, 67.10566893424036, 67.57006802721088, 68.0344671201814,
                    68.49886621315193, 68.96326530612245, 69.4508843537415, 69.91528344671202, 70.37968253968253,
                    70.84408163265306, 71.30848072562358, 71.79609977324263, 72.26049886621315, 72.72489795918368,
                    73.18929705215419, 73.65369614512471, 74.14131519274376, 74.55927437641724, 75.07011337868481,
                    75.53451247165533, 75.99891156462586, 76.46331065759637, 76.92770975056689, 77.41532879818594,
                    77.87972789115646, 78.34412698412699, 78.80852607709751, 79.27292517006802, 79.73732426303854,
                    80.2249433106576, 80.68934240362812, 81.15374149659864, 81.61814058956917, 82.08253968253969,
                    82.5469387755102, 83.03455782312925, 83.49895691609977, 83.9633560090703, 84.42775510204082,
                    84.91537414965987, 85.37977324263039, 85.8441723356009, 86.30857142857143, 86.77297052154195,
                    87.23736961451247, 87.72498866213152, 88.18938775510205, 88.65378684807256, 89.11818594104308,
                    89.5825850340136, 90.07020408163265, 90.5578231292517, 91.02222222222223, 91.48662131519275,
                    91.95102040816326, 92.36897959183673, 92.78693877551021, 93.20489795918367, 93.62285714285714,
                    94.06403628117914, 94.52843537414967, 95.0160544217687, 95.48045351473922, 95.94485260770975,
                    96.40925170068027, 96.8736507936508, 97.33804988662132, 97.80244897959183, 98.29006802721088,
                    98.7544671201814, 99.21886621315193, 99.68326530612245, 100.14766439909297, 100.6120634920635,
                    101.09968253968253, 101.56408163265306, 102.02848072562358, 102.4928798185941, 102.95727891156463,
                    103.42167800453515, 103.88607709750566, 104.35047619047619, 104.81487528344671, 105.27927437641723,
                    105.74367346938776, 106.20807256235828, 106.67247165532879, 107.13687074829932, 107.57804988662132,
                    108.01922902494331, 108.4604081632653, 108.92480725623582, 109.38920634920635, 109.85360544217687,
                    110.3180045351474, 110.78240362811792, 111.24680272108843, 111.71120181405895, 112.17560090702948,
                    112.64, 113.10439909297052, 113.56879818594105, 114.03319727891156, 114.49759637188208,
                    114.9619954648526, 115.42639455782313, 115.89079365079365, 116.35519274376418, 116.81959183673469,
                    117.28399092970521, 117.74839002267574, 118.21278911564626, 118.67718820861678, 119.14158730158731,
                    119.60598639455782, 120.07038548752834, 120.53478458049887, 120.99918367346939, 121.46358276643991,
                    121.92798185941044, 122.41560090702947, 122.88, 123.34439909297052, 123.80879818594104,
                    124.27319727891157, 124.76081632653062, 125.22521541950114, 125.68961451247165, 126.15401360544217,
                    126.64163265306122, 127.10603174603175, 127.57043083900227, 128.03482993197278, 128.4992290249433,
                    128.98684807256237, 129.4512471655329, 129.91564625850341, 130.3800453514739, 130.84444444444443,
                    131.3320634920635, 131.79646258503402, 132.26086167800455, 132.72526077097507, 133.18965986394556,
                    133.67727891156463, 134.14167800453515, 134.55963718820863, 135.0704761904762, 135.53487528344672,
                    135.99927437641725, 136.46367346938774, 136.92807256235827, 137.41569160997733, 137.88009070294785,
                    138.34448979591838, 138.8088888888889, 139.2732879818594, 139.76090702947846, 140.22530612244898,
                    140.6897052154195, 141.15410430839003, 141.61850340136056, 142.1061224489796, 142.57052154195011,
                    143.03492063492064, 143.49931972789116, 143.9637188208617, 144.4281179138322, 144.91573696145124,
                    145.38013605442177, 145.8445351473923, 146.30893424036282, 146.79655328798185, 147.26095238095238,
                    147.7253514739229, 148.18975056689342, 148.65414965986395, 149.14176870748298, 149.6061678004535,
                    150.07056689342403, 150.53496598639455, 150.99936507936508, 151.4637641723356, 151.95138321995464,
                    152.41578231292516, 152.88018140589568, 153.3445804988662, 153.80897959183673, 154.2965986394558,
                    154.7609977324263, 155.2253968253968, 155.68979591836734, 156.15419501133786, 156.6185941043084,
                    157.10621315192745, 157.57061224489797, 158.03501133786847, 158.499410430839, 158.96380952380952,
                    159.45142857142858, 159.9158276643991, 160.38022675736963, 160.84462585034012, 161.30902494331065,
                    161.7966439909297, 162.26104308390023, 162.72544217687076, 163.18984126984128, 163.6542403628118,
                    164.1186394557823, 164.5598185941043, 165.0706575963719, 165.5350566893424, 165.99945578231294,
                    166.46385487528346, 166.9514739229025, 167.41587301587302, 167.88027210884354, 168.34467120181407,
                    168.8090702947846, 169.29668934240362, 169.76108843537415, 170.22548752834467, 170.6898866213152,
                    171.15428571428572, 171.61868480725624, 172.10630385487528, 172.5707029478458, 173.03510204081633,
                    173.49950113378685, 173.96390022675737, 174.4282993197279, 174.91591836734693, 175.38031746031746,
                    175.84471655328798, 176.3091156462585, 176.79673469387754, 177.26113378684806, 177.7255328798186,
                    178.1899319727891, 178.65433106575964, 179.11873015873016, 179.58312925170068, 180.00108843537416,
                    180.41904761904763, 180.86022675736962, 181.3014058956916, 181.74258503401362, 182.1837641723356,
                    182.64816326530612, 183.11256235827665, 183.57696145124717, 184.0645804988662, 184.52897959183673,
                    184.99337868480725, 185.45777777777778, 185.9221768707483, 186.40979591836734, 186.87419501133786,
                    187.33859410430838, 187.8029931972789, 188.26739229024943, 188.75501133786847, 189.219410430839,
                    189.68380952380951, 190.14820861678004, 190.61260770975056, 191.0770068027211, 191.56462585034015,
                    192.02902494331065, 192.49342403628117, 192.9578231292517, 193.42222222222222, 193.88662131519274,
                    194.35102040816327
                };
        }
    }
}